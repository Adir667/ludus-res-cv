<!DOCTYPE html>
<html>
<head>
    <title>Upload Video</title>
    <script>
        function displayVideoDetails() {
            var fileInput = document.getElementById("videoFile");
            var fileSize = fileInput.files[0].size;
            
            var video = document.createElement("video");
            video.preload = "metadata";
            video.onloadedmetadata = function() {
                var resolution = this.videoWidth + "x" + this.videoHeight;
                var videoDetails = document.getElementById("videoDetails");
                videoDetails.innerHTML = "File Size: " + fileSize + " bytes<br>Resolution: " + resolution;
                
                // Send API request to get estimated processing time
                var url = "/estimate_processing_time";
                var params = "resolution=" + resolution + "&fileSize=" + fileSize;
                
                fetch(url, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: params
                })
                .then(response => response.json())
                .then(data => {
                    console.log(response)
                    var processingTime = data.processingTime;
                    videoDetails.innerHTML += "<br>Estimated Processing Time: " + processingTime + " seconds";
                })
                .catch(error => {
                    console.log("Error:", error);
                });
            };
            video.src = URL.createObjectURL(fileInput.files[0]);
        }
        
        function submitForm(event) {
            event.preventDefault();
            var form = document.getElementById("uploadForm");
            var formData = new FormData(form);
            
            fetch(form.action, {
                method: form.method,
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                var result = document.getElementById("uploadResult");
                result.innerHTML = "Upload Result: " + data.message;
            })
            .catch(error => {
                console.log("Error:", error);
            });
        }
    </script>
</head>
<body>
    <h1>Upload Video</h1>
    <form id="uploadForm" action="/dummy-data" method="POST" enctype="multipart/form-data" onsubmit="submitForm(event)">
        <input type="file" id="videoFile" name="videoFile" onchange="displayVideoDetails()">
        <button type="submit">Upload</button>
    </form>
    <div id="videoDetails"></div>
    <div id="uploadResult"></div>
</body>
</html>
